{
  "openapi": "3.0.1",
  "info": {
    "title": "Smart Surf Spots API",
    "description": "API para gestão de spots de surf com autenticação JWT",
    "version": "v1"
  },
  "paths": {
    "/api/Auth/register": {
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "Regista um novo utilizador no sistema.",
        "description": "Cria uma nova conta de utilizador com os dados fornecidos e retorna a confirmação.",
        "requestBody": {
          "description": "O objeto contendo os dados de registo (Nome, Email, Password).",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RegisterRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/RegisterRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/RegisterRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Utilizador registado com sucesso."
          },
          "400": {
            "description": "Falha na validação dos dados ou o utilizador já existe.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          }
        }
      }
    },
    "/api/Auth/login": {
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "Autentica um utilizador e gera um token de acesso (JWT).",
        "description": "Verifica as credenciais (email e password). Se corretas, retorna um token para ser usado nos endpoints protegidos.",
        "requestBody": {
          "description": "Credenciais de acesso do utilizador.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Login efetuado com sucesso."
          },
          "400": {
            "description": "Credenciais inválidas (email ou password incorretos).",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          }
        }
      }
    },
    "/api/Auth/profile": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Obtém o perfil do utilizador atualmente autenticado.",
        "description": "Requer um token JWT válido no cabeçalho Authorization.\r\nExtrai o ID do utilizador das Claims do token.",
        "responses": {
          "200": {
            "description": "Perfil obtido com sucesso."
          },
          "401": {
            "description": "Utilizador não autenticado ou token inválido.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "400": {
            "description": "Erro ao processar o pedido ou utilizador não encontrado.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          }
        }
      }
    },
    "/api/Spots": {
      "get": {
        "tags": [
          "Spots"
        ],
        "summary": "Lista todos os spots de surf disponíveis.",
        "description": "Retorna uma lista completa de spots registados na plataforma.\r\nRequer autenticação.",
        "responses": {
          "200": {
            "description": "Lista obtida com sucesso."
          },
          "401": {
            "description": "Utilizador não autenticado.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "400": {
            "description": "Erro ao processar o pedido.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "Spots"
        ],
        "summary": "Cria um novo spot de surf.",
        "description": "O utilizador autenticado será associado como criador do spot.",
        "requestBody": {
          "description": "Dados do novo spot (Nome, Localização, Dificuldade, etc.).",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSpotRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSpotRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSpotRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Spot criado com sucesso."
          },
          "400": {
            "description": "Dados inválidos ou erro na criação.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "401": {
            "description": "Utilizador não autenticado.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          }
        }
      }
    },
    "/api/Spots/{id}": {
      "get": {
        "tags": [
          "Spots"
        ],
        "summary": "Obtém os detalhes de um spot específico pelo ID.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "O identificador único do spot.",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Spot encontrado com sucesso."
          },
          "404": {
            "description": "Spot não encontrado.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "401": {
            "description": "Utilizador não autenticado.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "Spots"
        ],
        "summary": "Atualiza um spot existente.",
        "description": "Apenas o criador do spot (ou admin) deve conseguir realizar esta ação (validado no serviço).",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "ID do spot a atualizar.",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "requestBody": {
          "description": "Novos dados do spot.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateSpotRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateSpotRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateSpotRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Spot atualizado com sucesso."
          },
          "400": {
            "description": "Erro de validação ou permissão negada.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "401": {
            "description": "Utilizador não autenticado.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Spots"
        ],
        "summary": "Apaga um spot do sistema.",
        "description": "Apenas o criador ou admin podem apagar o spot.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "ID do spot a remover.",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Spot apagado com sucesso."
          },
          "400": {
            "description": "Erro ao apagar (ex: spot não existe ou sem permissão).",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "401": {
            "description": "Utilizador não autenticado.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          }
        }
      }
    },
    "/api/spots/{spotId}/Weather": {
      "get": {
        "tags": [
          "Weather"
        ],
        "summary": "Obtém as condições meteorológicas e de surf para um spot específico.",
        "description": "Retorna dados como altura das ondas, direção do vento, temperatura e período das ondas.\r\nÚtil para verificar se o spot está \"surfável\" no momento.",
        "parameters": [
          {
            "name": "spotId",
            "in": "path",
            "description": "O ID do spot para o qual se pretende a previsão.",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Dados meteorológicos obtidos com sucesso."
          },
          "400": {
            "description": "Erro ao obter dados (ex: ID inválido ou falha no serviço externo).",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "401": {
            "description": "Utilizador não autenticado.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "404": {
            "description": "Spot não encontrado (se o serviço suportar esta verificação).",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "CreateSpotRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "nullable": true
          },
          "latitude": {
            "type": "number",
            "format": "double"
          },
          "longitude": {
            "type": "number",
            "format": "double"
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "level": {
            "type": "integer",
            "format": "int32"
          }
        },
        "additionalProperties": false
      },
      "LoginRequest": {
        "required": [
          "email",
          "password"
        ],
        "type": "object",
        "properties": {
          "email": {
            "minLength": 1,
            "type": "string",
            "format": "email"
          },
          "password": {
            "minLength": 1,
            "type": "string"
          }
        },
        "additionalProperties": false
      },
      "ProblemDetails": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "nullable": true
          },
          "title": {
            "type": "string",
            "nullable": true
          },
          "status": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "detail": {
            "type": "string",
            "nullable": true
          },
          "instance": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": { }
      },
      "RegisterRequest": {
        "required": [
          "email",
          "name",
          "password"
        ],
        "type": "object",
        "properties": {
          "name": {
            "maxLength": 100,
            "minLength": 3,
            "type": "string"
          },
          "email": {
            "minLength": 1,
            "type": "string",
            "format": "email"
          },
          "password": {
            "minLength": 6,
            "type": "string"
          }
        },
        "additionalProperties": false
      },
      "UpdateSpotRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "nullable": true
          },
          "latitude": {
            "type": "number",
            "format": "double"
          },
          "longitude": {
            "type": "number",
            "format": "double"
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "level": {
            "type": "integer",
            "format": "int32"
          }
        },
        "additionalProperties": false
      }
    },
    "securitySchemes": {
      "Bearer": {
        "type": "apiKey",
        "description": "JWT Authorization header usando o esquema Bearer. Exemplo: 'Bearer {token}'",
        "name": "Authorization",
        "in": "header"
      }
    }
  },
  "security": [
    {
      "Bearer": [ ]
    }
  ]
}